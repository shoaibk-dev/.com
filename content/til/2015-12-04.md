+++
date = "2015-12-04T00:00:00"
title = "#TIL 2015-12-04 : sysadmin, websocket, log, python, clone, ref-var, til, cli-server, docker, php"
description = "I learned in 2015-12-04 about Run built-in server via Docker; Reference assign object variable; View real-time logs using websocketd"
categories = ["Today I learned", "python", "sysadmin", "php"]
tags = ["sysadmin", "websocket", "log", "python", "clone", "ref-var", "til", "cli-server", "docker", "php"]
+++


# PHP

## Run built-in server via Docker

Docker is the fast and clean way to run Linux programs.

We can run a PHP project via PHP built-in server and Docker.

```bash
docker run -it -p 8080:8080 -v `pwd`:/code php:7 php -S 0.0.0.0:8080 -t /code/web /code/web/server.php
```

With `server.php` content is

```php
<?php

$filename = __DIR__.preg_replace('#(\?.*)$#', '', $_SERVER['REQUEST_URI']);
if (php_sapi_name() === 'cli-server' && is_file($filename)) {
    return false;

}

// Run application below
$app = new Application();
$app->run();
```

# PYTHON

## Reference assign object variable

When you have a object `x` and assign `y = x`, `y` will be a ref of `x` (it looks like pointer of C). So changing property of `y` means changing property of `x`.

Ex :

```python
x = {"a": 1, "b": 2}
y = x
y['a'] = 100
print x['a'] # Result is 100
```

So if you want clone the value, use `copy` lib :

```python
import copy
x = {"a": 1, "b": 2}
y = copy.deepcopy(x)
y['a'] = 100
print x['a'] # Result is 1
```

# SYSADMIN

## View real-time logs using websocketd

I found a handy tool for making a websocket right on your shell.
It is **websocketd** : http://websocketd.com/

Its phisolophy is so simple :
> Just read incoming text from stdin and write outgoing text to stdout. Messaging is simple.

Read its docs, I follow the ez tutorial `10 second tutorial` and see how cool does it work.
Let make something cool with this, we got a UNIX tool that print out to `stdout` in real-time with changes of end file.

Ok cool, change the command to
```bash
websocketd --port=8080 tail -f logs/web_access.log
```

Tada ! Open the webpage that listens the websocket you made and see the magic :D You can tracking access log of website or system in real-time way.
